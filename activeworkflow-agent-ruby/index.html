<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="search" type="application/opensearchdescription+xml" title="ActiveWorkflow Documentation" href="/opensearch.xml"><title data-react-helmet="true">ActiveWorkflow Agent Ruby | ActiveWorkflow Documentation</title><meta data-react-helmet="true" property="og:image" content="https://docs.activeworkflow.org/img/AW_preview.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.activeworkflow.org/img/AW_preview.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for ActiveWorkflow Documentation"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ActiveWorkflow Agent Ruby | ActiveWorkflow Documentation"><meta data-react-helmet="true" name="description" content="Helps you to develop your own ActiveWorkflow agents in Ruby."><meta data-react-helmet="true" property="og:description" content="Helps you to develop your own ActiveWorkflow agents in Ruby."><meta data-react-helmet="true" property="og:url" content="https://docs.activeworkflow.org/activeworkflow-agent-ruby"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://docs.activeworkflow.org/activeworkflow-agent-ruby"><link rel="stylesheet" href="/styles.a6a4f5c2.css">
<link rel="preload" href="/styles.4bd87d89.js" as="script">
<link rel="preload" href="/runtime~main.3a4f44fa.js" as="script">
<link rel="preload" href="/main.455a99f5.js" as="script">
<link rel="preload" href="/1.e0509423.js" as="script">
<link rel="preload" href="/18.88427751.js" as="script">
<link rel="preload" href="/21.0a5f1eef.js" as="script">
<link rel="preload" href="/935f2afb.1e6c5fe0.js" as="script">
<link rel="preload" href="/17.cbf1f39d.js" as="script">
<link rel="preload" href="/d6bbbd14.3359168c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/AW-logo.svg" alt="ActiveWorkflow Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/AW-logo.svg" alt="ActiveWorkflow Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">ActiveWorkflow Documentation</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/automaticmode/active_workflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/AW-logo.svg" alt="ActiveWorkflow Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/AW-logo.svg" alt="ActiveWorkflow Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">ActiveWorkflow Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/automaticmode/active_workflow" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">ActiveWorkflow</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/use-cases">Use Cases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/activeworkflow-basics">ActiveWorkflow Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/built-in-agents">Built-in Agents</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/agent-examples">Examples of Custom Agents</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/remote-agent-api">Remote Agent API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/rest-api">Client REST API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/deployment">Deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/roadmap">Roadmap</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Helper Libraries</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/activeworkflow-agent-python">ActiveWorkflow Agent Python</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/activeworkflow-agent-ruby">ActiveWorkflow Agent Ruby</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">ActiveWorkflow Agent Ruby</h1></header><div class="markdown"><blockquote><p>Helps you to develop your own ActiveWorkflow agents in Ruby.</p></blockquote><p>The <code>active_workflow_agent</code> library helps you to write your own ActiveWorkflow
agents in Ruby using ActiveWorkflow&#x27;s <a href="/remote-agent-api/">remote agent API</a>.
‚ÄúRemote‚Äù in this context means that agents run in separate processes
from ActiveWorkflow itself. Communication between agents and ActiveWorkflow
takes place via HTTP. Each agent is effectively an HTTP server which ActiveWorkflow
connects to and interacts with via the <a href="/remote-agent-api/#protocol">remote agent API protocol</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="installation"></a>Installation<a class="hash-link" href="#installation" title="Direct link to heading">#</a></h2><p>Add this line to your agent&#x27;s Gemfile:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">gem &#x27;active_workflow_agent&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>And then execute:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ bundle install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Or install it yourself as:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ gem install active_workflow_agent</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="the-activeworkflow-agent-api-protocol"></a>The ActiveWorkflow Agent API Protocol<a class="hash-link" href="#the-activeworkflow-agent-api-protocol" title="Direct link to heading">#</a></h2><p>ActiveWorkflow talks to an agent over HTTP and all the requests and responses
are in JSON. All communication happens using a single endpoint (the agent&#x27;s
registered URL) and an agent has to implement and handle the following
3 ‚Äúmethods‚Äù:</p><ul><li><strong>register</strong>: called to retrieve an agent&#x27;s metadata (name, description, options).</li><li><strong>receive</strong>: called when an agent has to process a message.</li><li><strong>check</strong>: called on schedule (as set by ActiveWorkflow users) and has no message to process.</li></ul><p>For more details please see the <a href="/remote-agent-api#protocol">remote agent API protocol</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="library-functionality"></a>Library Functionality<a class="hash-link" href="#library-functionality" title="Direct link to heading">#</a></h2><p>To deal with the protocol in your agent implementation this library offers four
helper classes that are described below.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="parsedrequest"></a>ParsedRequest<a class="hash-link" href="#parsedrequest" title="Direct link to heading">#</a></h3><p><code>ParsedRequest</code> is a helper class to parse the content of a <a href="/remote-agent-api#protocol">request</a>
from the <a href="/remote-agent-api">ActiveWorkflow Agent API</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="public-class-methods"></a>Public Class Methods<a class="hash-link" href="#public-class-methods" title="Direct link to heading">#</a></h4><p><code>::new(request)</code> - create a new ParsedRequest object.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="attributes"></a>Attributes<a class="hash-link" href="#attributes" title="Direct link to heading">#</a></h4><p>A ParsedRequest object always has the following attributes:</p><ul><li><strong>method</strong>: a symbol representing the method called on the agent.</li><li><strong>options</strong>: a hash with all the agent options.</li><li><strong>memory</strong>: a hash with the state of the agent.</li><li><strong>credentials</strong>: an array of hashes containing credentials that the agent might need.</li><li><strong>message</strong>: a hash containing the message the agent received.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example"></a>Example<a class="hash-link" href="#example" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &#x27;active_workflow_agent&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">request = ActiveWorkflowAgent::ParsedRequest.new(request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">request.method       # =&gt; :receive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">request.options      # =&gt; {&quot;some&quot;: &quot;option&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">request.memory       # =&gt; {&quot;could&quot;: {&quot;be&quot;: &quot;anything&quot;}}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">request.credentials  # =&gt; [{&quot;name&quot;: &quot;admin_email&quot;, &quot;value&quot;: &quot;admin@example.com&quot;}]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">request.message      # =&gt; {&quot;a&quot;: 1, &quot;b&quot;: 2}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="registerresponse"></a>RegisterResponse<a class="hash-link" href="#registerresponse" title="Direct link to heading">#</a></h3><p><code>RegisterResponse</code> is a helper class to construct a response to the <a href="/remote-agent-api#the-register-method">&#x27;register&#x27; method</a> API call. It has the following methods:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="public-class-methods-1"></a>Public Class Methods<a class="hash-link" href="#public-class-methods-1" title="Direct link to heading">#</a></h4><p><code>::new(name:, display_name:, description:, default_options:)</code> - create a new RegisterResponse object. Arguments:</p><ul><li>name: a unique identifier string in upper CamelCase without any whitespace.</li><li>display_name: a string containing the name of the agent for display purposes.</li><li>description: a string containing the description of the agent in markdown format.</li><li>default_options: (optional) a hash containing the agent&#x27;s options.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="public-instance-methods"></a>Public Instance Methods<a class="hash-link" href="#public-instance-methods" title="Direct link to heading">#</a></h4><ul><li><code>#to_h()</code>: returns the response as a hash.</li><li><code>#to_json()</code>: returns the response as a JSON string.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-1"></a>Example<a class="hash-link" href="#example-1" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &#x27;active_workflow_agent&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response = ActiveWorkflowAgent::RegisterResponse.new(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             name: &quot;ExampleAgent&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             display_name: &quot;Example Agent&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             description: &quot;Just an example agent.&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">             default_options: {&quot;a&quot;: &quot;b&quot;}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">           )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response.to_json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># =&gt; &#x27;{&quot;result&quot;: {&quot;name&quot;: &quot;ExampleAgent&quot;, &quot;display_name&quot;: &quot;Example Agent&quot;, &quot;description&quot;: &quot;Just an example agent.&quot;, &quot;default_options&quot;: {&quot;a&quot;: &quot;b&quot;}}}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="checkresponse"></a>CheckResponse<a class="hash-link" href="#checkresponse" title="Direct link to heading">#</a></h3><p><code>CheckResponse</code> is helper class to construct a response to the <a href="/remote-agent-api#the-check-method">&#x27;check&#x27; method</a> API call.</p><ul><li><code>#add_logs(*str)</code>: add one or more log messages to the response object.</li><li><code>#add_errors(*str)</code>: add one or more error messages to the response object.</li><li><code>#add_messages(*hash)</code>: add the messages that the agent will emit.</li><li><code>#add_memory(hash)</code>: add the agent&#x27;s memory (state) to the response object.</li><li><code>#to_h()</code>: returns the response as a hash.</li><li><code>#to_json()</code>: returns the response as a JSON string.</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &#x27;active_workflow_agent&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response = ActiveWorkflowAgent::CheckResponse.new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response.add_logs(&quot;Check done&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response.add_errors(&quot;An error occurred&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response.to_h</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># =&gt; &#x27;{&quot;result&quot;: {&quot;errors&quot;: [&quot;An error occurred&quot;], &quot;logs&quot;: [&quot;Check done&quot;], &quot;memory&quot;: {}, &quot;messages&quot;: []}}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="receiveresponse"></a>ReceiveResponse<a class="hash-link" href="#receiveresponse" title="Direct link to heading">#</a></h3><p><code>ReceiveResponse</code> is a helper class to construct a response to the <a href="/remote-agent-api#the-receive-method">&#x27;receive&#x27; method</a> API call.</p><ul><li><code>#add_logs(*str)</code>: add one or more log messages to the response object.</li><li><code>#add_errors(*str)</code>: add one or more error messages to the response object.</li><li><code>#add_messages(*hash)</code>: add the messages that the agent will emit.</li><li><code>#add_memory(hash)</code>: add the agent&#x27;s memory (state) to the response object.</li><li><code>#to_h()</code>: returns the response as a hash.</li><li><code>#to_json()</code>: returns the response as a JSON string.</li></ul><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &#x27;active_workflow_agent&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response = ActiveWorkflowAgent::ReceiveResponse.new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response.add_logs(&quot;New message received&quot;, &quot;Message processed&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">response.to_json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># =&gt; &#x27;{&quot;result&quot;: {&quot;errors&quot;: [], &quot;logs&quot;: [&quot;New message received&quot;, &quot;Message processed&quot;], &quot;memory&quot;: {}, &quot;messages&quot;: []}}&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-agent"></a>Example Agent<a class="hash-link" href="#example-agent" title="Direct link to heading">#</a></h2><p>Below you can find an example of an ActiveWorkflow agent using the library helper classes.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-ruby codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &quot;sinatra&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">require &quot;active_workflow_agent&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">post &quot;/&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  req = JSON.parse request.body.read</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  parsed_request = ActiveWorkflowAgent::ParsedRequest.new(req)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  case parsed_request.method</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  when :register</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    respond_to_register</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  when :check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    respond_to_check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  when :receive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    respond_to_receive(parsed_request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def respond_to_register</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ActiveWorkflowAgent::RegisterResponse.new(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name: &quot;ExampleAgent&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    display_name: &quot;Example Agent&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    description: &quot;This is a simple agent that does nothing.&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ).to_json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def respond_to_check</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response = ActiveWorkflowAgent::CheckResponse.new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.add_logs(&quot;A log message&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.add_messages(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    { &quot;Message&quot; =&gt; &quot;in a bottle&quot; },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    { &quot;Something&quot; =&gt; &quot;else&quot; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.to_json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def respond_to_receive(parsed_request)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response = ActiveWorkflowAgent::CheckResponse.new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.add_errors(&quot;Log an error&quot;, &quot;Another error&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # Devise some memory hash.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  memory = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;previous_memory&quot; =&gt; parsed_request.memory,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;message_received&quot; =&gt; parsed_request.message</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.add_memory(memory)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.add_messages({ &quot;message_received&quot; =&gt; parsed_request.message })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  response.to_json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="running-an-agent-locally-for-development"></a>Running an Agent Locally for Development<a class="hash-link" href="#running-an-agent-locally-for-development" title="Direct link to heading">#</a></h2><p>Suppose that for development purposes you have created a simple agent that can run locally on <code>http://0.0.0.0:4567</code> and you also run ActiveWorkflow using Docker. You would typically proceed in the following manner:</p><ol><li>You would first start your agent process at <code>http://0.0.0.0:4567</code>.</li><li>You would then start ActiveWorkflow locally with Docker, registering your agent by passing an environment variable. For example: <code>docker run -e REMOTE_AGENT_URL=&quot;http://host.docker.internal:4567/&quot; -p 3000:3000 --rm automaticmode/active_workflow</code>.</li><li>When starting, ActiveWorkflow would make a request to your agent at <code>http://0.0.0.0:4567</code> with the &#x27;register&#x27; method, in order to retrieve your agent&#x27;s information. (see <a href="/remote-agent-api/#the-register-method">the register method</a> for the details).</li><li>You would then log in to ActiveWorkflow, go to &#x27;create a new agent&#x27; panel, select the agent with the name and description provided as a response to the &#x27;<strong>register</strong>&#x27; method, and you would create an instance of this agent. You or other users could create multiple instances of this agent, possibly with different options (if your agent is configurable).</li><li>If you schedule your agent instance to be invoked periodically, then ActiveWorkflow would make a request to <code>http://0.0.0.0:4567</code> at the scheduled time with the method &#x27;<strong>check</strong>&#x27;.</li><li>Every time your agent receives a message from another agent, ActiveWorkflow would call it with the method &#x27;<strong>receive</strong>&#x27; passing the message along.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="source-code"></a>Source Code<a class="hash-link" href="#source-code" title="Direct link to heading">#</a></h2><p>You can find the <a href="https://github.com/automaticmode/active_workflow_agent" target="_blank" rel="noopener noreferrer">activeworkflow_agent source code on GitHub</a>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/activeworkflow-agent-python"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ ActiveWorkflow Agent Python</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation" class="table-of-contents__link">Installation</a></li><li><a href="#the-activeworkflow-agent-api-protocol" class="table-of-contents__link">The ActiveWorkflow Agent API Protocol</a></li><li><a href="#library-functionality" class="table-of-contents__link">Library Functionality</a><ul><li><a href="#parsedrequest" class="table-of-contents__link">ParsedRequest</a></li><li><a href="#registerresponse" class="table-of-contents__link">RegisterResponse</a></li><li><a href="#checkresponse" class="table-of-contents__link">CheckResponse</a></li><li><a href="#receiveresponse" class="table-of-contents__link">ReceiveResponse</a></li></ul></li><li><a href="#example-agent" class="table-of-contents__link">Example Agent</a></li><li><a href="#running-an-agent-locally-for-development" class="table-of-contents__link">Running an Agent Locally for Development</a></li><li><a href="#source-code" class="table-of-contents__link">Source Code</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.automaticmode.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Automatic Mode Labs Logo" src="/img/AML-logo.svg"></a></div><div class="footer__copyright">Copyright &copy; 2021 Automatic Mode Labs AG</div></div></div></footer></div>
<script src="/styles.4bd87d89.js"></script>
<script src="/runtime~main.3a4f44fa.js"></script>
<script src="/main.455a99f5.js"></script>
<script src="/1.e0509423.js"></script>
<script src="/18.88427751.js"></script>
<script src="/21.0a5f1eef.js"></script>
<script src="/935f2afb.1e6c5fe0.js"></script>
<script src="/17.cbf1f39d.js"></script>
<script src="/d6bbbd14.3359168c.js"></script>
</body>
</html>