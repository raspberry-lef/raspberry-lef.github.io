(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{74:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return c}));var a=n(3),i=n(7),r=(n(0),n(89)),l={id:"rest-api",title:"Client REST API",sidebar_label:"Client REST API"},o={unversionedId:"rest-api",id:"rest-api",isDocsHomePage:!1,title:"Client REST API",description:"How to Query and Control Your Agents and Workflows Programmatically",source:"@site/docs/rest-api.md",slug:"/rest-api",permalink:"/rest-api",version:"current",sidebar_label:"Client REST API",sidebar:"someSidebar",previous:{title:"Remote Agent API",permalink:"/remote-agent-api"},next:{title:"Deployment",permalink:"/deployment"}},s=[{value:"Versioning",id:"versioning",children:[]},{value:"Authorization",id:"authorization",children:[]},{value:"Endpoints",id:"endpoints",children:[{value:"<code>GET /api/v1/agents</code>",id:"get-apiv1agents",children:[]},{value:"<code>GET /api/v1/agents/:agent_id</code>",id:"get-apiv1agentsagent_id",children:[]},{value:"<code>GET /api/v1/agents/:agent_id/messages</code>",id:"get-apiv1agentsagent_idmessages",children:[]},{value:"<code>GET /api/v1/messages/:message_id</code>",id:"get-apiv1messagesmessage_id",children:[]},{value:"<code>GET /api/v1/workflows</code>",id:"get-apiv1workflows",children:[]},{value:"<code>GET /api/v1/workflows/:workflow_id</code>",id:"get-apiv1workflowsworkflow_id",children:[]}]},{value:"Errors",id:"errors",children:[]}],b={toc:s};function c(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"How to Query and Control Your Agents and Workflows Programmatically")),Object(r.b)("p",null,"ActiveWorkflow exposes a REST API that allows you to query and control your agents and workflows programmatically."),Object(r.b)("p",null,"Currently the API is read-only, which is helpful for implementing dashboards or for getting the results of various workflows and feeding them into other systems. The REST API will be expanded as we go forward. All responses returned by ActiveWorkflow's API are in JSON format."),Object(r.b)("p",null,"Table of Contents:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#versioning"}),"Versioning")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#authorization"}),"Authorization")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#Endpoints"}),"Endpoints"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#get-apiv1agents"}),Object(r.b)("inlineCode",{parentName:"a"},"GET /api/v1/agents"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#get-apiv1agentsagent_id"}),Object(r.b)("inlineCode",{parentName:"a"},"GET /api/v1/agents/:agent_id"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#get-apiv1agentsagent_idmessages"}),Object(r.b)("inlineCode",{parentName:"a"},"GET /api/v1/agents/:agent_id/messages"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#get-apiv1messagesmessage_id"}),Object(r.b)("inlineCode",{parentName:"a"},"GET /api/v1/messages/:message_id"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#get-apiv1workflows"}),Object(r.b)("inlineCode",{parentName:"a"},"GET /api/v1/workflows"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#get-apiv1workflowsworkflow_id"}),Object(r.b)("inlineCode",{parentName:"a"},"GET /api/v1/workflows/:workflow_id"))))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#Errors"}),"Errors"))),Object(r.b)("h2",{id:"versioning"},"Versioning"),Object(r.b)("p",null,"This is ",Object(r.b)("strong",{parentName:"p"},"version 1")," of ActiveWorkflow API which is indicated by the URL. This\nAPI may change in the future in a backwards compatible way. New endpoints and\nparameters (optional) can be added without invalidating existing functionality.\nDocumented response fields may not be exhaustive - an API client should always\nexpect that more fields can be returned."),Object(r.b)("p",null,"If any incompatible changes were to be introduced, the API version would be\nupdated and the new API would be served with a different URL."),Object(r.b)("h2",{id:"authorization"},"Authorization"),Object(r.b)("p",null,"The ActiveWorkflow API uses a ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://jwt.io/introduction/"}),"JsonWebToken"),"-based\nauthorization mechanism. You can acquire an authorization token by connecting to\nthe usual ActiveWorkflow web UI with you user email and password. You can then find\nit under ",Object(r.b)("inlineCode",{parentName:"p"},"Account")," in ",Object(r.b)("inlineCode",{parentName:"p"},"User Settings"),"."),Object(r.b)("p",null,"Note: an authorization token is connected to the account of a specific user and therefore\ncan only provide access to the system only on behalf of that user."),Object(r.b)("p",null,"Currently API authorization tokens do not expire and allow full use of the\nAPI. Expiring and scoped APIs (like ",Object(r.b)("strong",{parentName:"p"},"read only"),") may be introduced later. An API\nclient should treat an authorization token as an opaque string and should not assume\nanything about its format or content."),Object(r.b)("p",null,"To authorize a request a client should put the authorization token into\nan HTTP ",Object(r.b)("inlineCode",{parentName:"p"},"Authorization")," header in the following format:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"Authorization: Bearer :token:\n")),Object(r.b)("p",null,"Where ",Object(r.b)("inlineCode",{parentName:"p"},":token:")," is the authorization token."),Object(r.b)("p",null,"Example invocation using curl:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),'curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxfQ.kG4Si_1WJyGrsvm9zTcubjpYKzCubgaGdyakGwuwaCs" http://localhost:3000/api/v1/workflows\n')),Object(r.b)("h2",{id:"endpoints"},"Endpoints"),Object(r.b)("h3",{id:"get-apiv1agents"},Object(r.b)("inlineCode",{parentName:"h3"},"GET /api/v1/agents")),Object(r.b)("p",null,"List all of a user's agents."),Object(r.b)("p",null,"Parameters - none."),Object(r.b)("p",null,"Response - array of hashes where each hash represents an agent. Each agent's\nhash has the following key/value pairs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"id")," - identifier of the agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"name")," - name of the agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"type")," - string indicating the type of the agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"disabled")," - true if agent is disabled, false otherwise;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"messages_count")," - number of messages emitted by this agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"source")," - array of the source agents, each entry is a hash with ",Object(r.b)("inlineCode",{parentName:"li"},"id"),"\nproperty.")),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"GET /api/v1/agents\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "id": 1,\n    "name": "Rerieve",\n    "type": "Agents::WebsiteAgent",\n    "disabled": false,\n    "messages_count": 2,\n    "sources": []\n  },\n  {\n    "id": 2,\n    "name": "Email",\n    "type": "Agents::EmailAgent",\n    "disabled": false,\n    "messages_count": 0,\n    "sources": [ { "id": 1 } ]\n  }\n]\n')),Object(r.b)("h3",{id:"get-apiv1agentsagent_id"},Object(r.b)("inlineCode",{parentName:"h3"},"GET /api/v1/agents/:agent_id")),Object(r.b)("p",null,"Get info on specific agent."),Object(r.b)("p",null,"Parameters - none."),Object(r.b)("p",null,"Response - a hash representing an agent that has the following key/value pairs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"id")," - identifier of the agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"name")," - name of the agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"type")," - string indicating the type of the agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"disabled")," - true if agent is disabled, false otherwise;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"messages_count")," - number of messages emitted by this agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"source")," - array of the source agents, each entry is a hash with ",Object(r.b)("inlineCode",{parentName:"li"},"id"),"\nproperty.")),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"GET /api/v1/agents/1\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "id": 1,\n  "name": "Rerieve",\n  "type": "Agents::WebsiteAgent",\n  "disabled": false,\n  "messages_count": 2,\n  "sources": []\n}\n')),Object(r.b)("h3",{id:"get-apiv1agentsagent_idmessages"},Object(r.b)("inlineCode",{parentName:"h3"},"GET /api/v1/agents/:agent_id/messages")),Object(r.b)("p",null,"Get the latest messages emitted by the agent."),Object(r.b)("p",null,"Parameters:"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"after")," - datetime (iso8601 string), only return the messages that where created\n",Object(r.b)("em",{parentName:"p"},"after")," the given time;"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"limit")," - integer, only return this number of the ",Object(r.b)("em",{parentName:"p"},"latest")," created messages. By\ndefault all the messages are returned."),Object(r.b)("p",null,"Response - an array of hashes where each hash represents a message and has the\nfollowing key/value pairs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"id")," - identifier of the message;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"agent_id")," - identifier of emitting agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"created_at")," - datetime (iso8601 string) of when the message was created;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"expires_at")," - datetime (iso8601 string) of when the message expires, never if\nnull.")),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"GET /api/v1/agents/1/messages?limit=1&after=2019-10-20T01:10:10.256-8:00\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "id": 1,\n    "agent_id": 1,\n    "created_at": "2019-10-20T02:01:14.122-8:00",\n    "expires_at": "2019-10-21T02:01:14.122-8:00"\n  },\n  {\n    "id": 2,\n    "agent_id": 1,\n    "created_at": "2019-10-20T02:02:13.317-8:00",\n    "expires_at": "2019-10-21T02:02:13.317-8:00"\n  },\n]\n')),Object(r.b)("h3",{id:"get-apiv1messagesmessage_id"},Object(r.b)("inlineCode",{parentName:"h3"},"GET /api/v1/messages/:message_id")),Object(r.b)("p",null,"Get the message with the payload."),Object(r.b)("p",null,"Parameter - none."),Object(r.b)("p",null,"Response - a hash representing a message with the following key/value pairs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"id")," - identifier of a message;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"agent_id")," - identifier of emitting agent;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"created_at")," - datetime (iso8601 string) of when a message was created;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"expires_at")," - datetime (iso8601 string) of when a message expires, never if\nnull;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"payload")," - JSON document containing payload of the message.")),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"GET /api/v1/messages/1\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "id": 1,\n  "agent_id": 1,\n  "created_at": "2019-10-20T02:01:14.122-8:00",\n  "expires_at": "2019-10-21T02:01:14.122-8:00",\n  "payload": {\n    "title": "Lates news",\n    "author": "John Snow"\n  }\n}\n')),Object(r.b)("h3",{id:"get-apiv1workflows"},Object(r.b)("inlineCode",{parentName:"h3"},"GET /api/v1/workflows")),Object(r.b)("p",null,"Get a list of workflows."),Object(r.b)("p",null,"Parameters - none."),Object(r.b)("p",null,"Response - an array of hashes where each hash represent a workflow and has the\nfollowing key/value pairs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"id")," - identifier of the workflow;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"name")," - name of the workflow;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"description")," - description of the workflow.")),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"GET /api/v1/workflows\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'[\n  {\n    "id": 1,\n    "name": "My Workflow",\n    "description": "This workflow does stuff."\n  }\n]\n')),Object(r.b)("h3",{id:"get-apiv1workflowsworkflow_id"},Object(r.b)("inlineCode",{parentName:"h3"},"GET /api/v1/workflows/:workflow_id")),Object(r.b)("p",null,"Get a workflow ",Object(r.b)("em",{parentName:"p"},"with")," a list of agents that participate in that workflow."),Object(r.b)("p",null,"Parameters - none."),Object(r.b)("p",null,"Response - a hash that represents the workflow with the following key/value\npairs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"id")," - identifier of the workflow;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"name")," - name of the workflow;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"description")," - description of the workflow,"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"agents")," - array of hashes that describe agents participating in this workflow,\nformat matches response of the ",Object(r.b)("inlineCode",{parentName:"li"},"/api/v1/agents")," endpoint.")),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"GET /api/v1/workflows\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "id": 1,\n  "name": "My Workflow",\n  "description": "This workflow does stuff.",\n  "agents": [\n    {\n      "id": 1,\n      "name": "Rerieve",\n      "type": "Agents::WebsiteAgent",\n      "disabled": false,\n      "messages_count": 2,\n      "sources": []\n    },\n    {\n      "id": 2,\n      "name": "Email",\n      "type": "Agents::EmailAgent",\n      "disabled": false,\n      "messages_count": 0,\n      "sources": [ { "id": 1 } ]\n    }\n  ]\n}\n')),Object(r.b)("h2",{id:"errors"},"Errors"),Object(r.b)("p",null,"The API responds to failures using standard HTTP status codes. Additionally with a JSON\ndocument containing a single key ",Object(r.b)("inlineCode",{parentName:"p"},"error")," where its value is a short description of the\nerror."),Object(r.b)("p",null,"For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "error": "401 Unauthorized"\n}\n')),Object(r.b)("p",null,"Supported errors are:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"401")," - unauthorized, authorization header is missing or is invalid;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"404")," - record (agent, workflow of message) not found;"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"500")," - other unclassified errors (for now it includes parameter validation\nerrors).")))}c.isMDXComponent=!0},89:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var b=i.a.createContext({}),c=function(e){var t=i.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return i.a.createElement(b.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,b=s(e,["components","mdxType","originalType","parentName"]),p=c(n),u=a,m=p["".concat(l,".").concat(u)]||p[u]||d[u]||r;return n?i.a.createElement(m,o(o({ref:t},b),{},{components:n})):i.a.createElement(m,o({ref:t},b))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var b=2;b<r;b++)l[b]=n[b];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);